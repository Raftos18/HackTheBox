Ly8KLy8gVGhpcyBleHBsb2l0IHVzZXMgdGhlIHBva2Vtb24gZXhwbG9pdCBvZiB0aGUgZGlydHlj
b3cgdnVsbmVyYWJpbGl0eQovLyBhcyBhIGJhc2UgYW5kIGF1dG9tYXRpY2FsbHkgZ2VuZXJhdGVz
IGEgbmV3IHBhc3N3ZCBsaW5lLgovLyBUaGUgdXNlciB3aWxsIGJlIHByb21wdGVkIGZvciB0aGUg
bmV3IHBhc3N3b3JkIHdoZW4gdGhlIGJpbmFyeSBpcyBydW4uCi8vIFRoZSBvcmlnaW5hbCAvZXRj
L3Bhc3N3ZCBmaWxlIGlzIHRoZW4gYmFja2VkIHVwIHRvIC90bXAvcGFzc3dkLmJhawovLyBhbmQg
b3ZlcndyaXRlcyB0aGUgcm9vdCBhY2NvdW50IHdpdGggdGhlIGdlbmVyYXRlZCBsaW5lLgovLyBB
ZnRlciBydW5uaW5nIHRoZSBleHBsb2l0IHlvdSBzaG91bGQgYmUgYWJsZSB0byBsb2dpbiB3aXRo
IHRoZSBuZXdseQovLyBjcmVhdGVkIHVzZXIuCi8vCi8vIFRvIHVzZSB0aGlzIGV4cGxvaXQgbW9k
aWZ5IHRoZSB1c2VyIHZhbHVlcyBhY2NvcmRpbmcgdG8geW91ciBuZWVkcy4KLy8gICBUaGUgZGVm
YXVsdCBpcyAiZmlyZWZhcnQiLgovLwovLyBPcmlnaW5hbCBleHBsb2l0IChkaXJ0eWNvdydzIHB0
cmFjZV9wb2tlZGF0YSAicG9rZW1vbiIgbWV0aG9kKToKLy8gICBodHRwczovL2dpdGh1Yi5jb20v
ZGlydHljb3cvZGlydHljb3cuZ2l0aHViLmlvL2Jsb2IvbWFzdGVyL3Bva2Vtb24uYwovLwovLyBD
b21waWxlIHdpdGg6Ci8vICAgZ2NjIC1wdGhyZWFkIGRpcnR5LmMgLW8gZGlydHkgLWxjcnlwdAov
LwovLyBUaGVuIHJ1biB0aGUgbmV3bHkgY3JlYXRlIGJpbmFyeSBieSBlaXRoZXIgZG9pbmc6Ci8v
ICAgIi4vZGlydHkiIG9yICIuL2RpcnR5IG15LW5ldy1wYXNzd29yZCIKLy8KLy8gQWZ0ZXJ3YXJk
cywgeW91IGNhbiBlaXRoZXIgInN1IGZpcmVmYXJ0IiBvciAic3NoIGZpcmVmYXJ0QC4uLiIKLy8K
Ly8gRE9OJ1QgRk9SR0VUIFRPIFJFU1RPUkUgWU9VUiAvZXRjL3Bhc3N3ZCBBRlRFUiBSVU5OSU5H
IFRIRSBFWFBMT0lUIQovLyAgIG12IC90bXAvcGFzc3dkLmJhayAvZXRjL3Bhc3N3ZAovLwovLyBF
eHBsb2l0IGFkb3B0ZWQgYnkgQ2hyaXN0aWFuICJGaXJlRmFydCIgTWVobG1hdWVyCi8vIGh0dHBz
Oi8vZmlyZWZhcnQuYXQKLy8KCiNpbmNsdWRlIDxmY250bC5oPgojaW5jbHVkZSA8cHRocmVhZC5o
PgojaW5jbHVkZSA8c3RyaW5nLmg+CiNpbmNsdWRlIDxzdGRpby5oPgojaW5jbHVkZSA8c3RkaW50
Lmg+CiNpbmNsdWRlIDxzeXMvbW1hbi5oPgojaW5jbHVkZSA8c3lzL3R5cGVzLmg+CiNpbmNsdWRl
IDxzeXMvc3RhdC5oPgojaW5jbHVkZSA8c3lzL3dhaXQuaD4KI2luY2x1ZGUgPHN5cy9wdHJhY2Uu
aD4KI2luY2x1ZGUgPHN0ZGxpYi5oPgojaW5jbHVkZSA8dW5pc3RkLmg+CiNpbmNsdWRlIDxjcnlw
dC5oPgoKY29uc3QgY2hhciAqZmlsZW5hbWUgPSAiL2V0Yy9wYXNzd2QiOwpjb25zdCBjaGFyICpi
YWNrdXBfZmlsZW5hbWUgPSAiL3RtcC9wYXNzd2QuYmFrIjsKY29uc3QgY2hhciAqc2FsdCA9ICJm
aXJlZmFydCI7CgppbnQgZjsKdm9pZCAqbWFwOwpwaWRfdCBwaWQ7CnB0aHJlYWRfdCBwdGg7CnN0
cnVjdCBzdGF0IHN0OwoKc3RydWN0IFVzZXJpbmZvIHsKICAgY2hhciAqdXNlcm5hbWU7CiAgIGNo
YXIgKmhhc2g7CiAgIGludCB1c2VyX2lkOwogICBpbnQgZ3JvdXBfaWQ7CiAgIGNoYXIgKmluZm87
CiAgIGNoYXIgKmhvbWVfZGlyOwogICBjaGFyICpzaGVsbDsKfTsKCmNoYXIgKmdlbmVyYXRlX3Bh
c3N3b3JkX2hhc2goY2hhciAqcGxhaW50ZXh0X3B3KSB7CiAgcmV0dXJuIGNyeXB0KHBsYWludGV4
dF9wdywgc2FsdCk7Cn0KCmNoYXIgKmdlbmVyYXRlX3Bhc3N3ZF9saW5lKHN0cnVjdCBVc2VyaW5m
byB1KSB7CiAgY29uc3QgY2hhciAqZm9ybWF0ID0gIiVzOiVzOiVkOiVkOiVzOiVzOiVzXG4iOwog
IGludCBzaXplID0gc25wcmludGYoTlVMTCwgMCwgZm9ybWF0LCB1LnVzZXJuYW1lLCB1Lmhhc2gs
CiAgICB1LnVzZXJfaWQsIHUuZ3JvdXBfaWQsIHUuaW5mbywgdS5ob21lX2RpciwgdS5zaGVsbCk7
CiAgY2hhciAqcmV0ID0gbWFsbG9jKHNpemUgKyAxKTsKICBzcHJpbnRmKHJldCwgZm9ybWF0LCB1
LnVzZXJuYW1lLCB1Lmhhc2gsIHUudXNlcl9pZCwKICAgIHUuZ3JvdXBfaWQsIHUuaW5mbywgdS5o
b21lX2RpciwgdS5zaGVsbCk7CiAgcmV0dXJuIHJldDsKfQoKdm9pZCAqbWFkdmlzZVRocmVhZCh2
b2lkICphcmcpIHsKICBpbnQgaSwgYyA9IDA7CiAgZm9yKGkgPSAwOyBpIDwgMjAwMDAwMDAwOyBp
KyspIHsKICAgIGMgKz0gbWFkdmlzZShtYXAsIDEwMCwgTUFEVl9ET05UTkVFRCk7CiAgfQogIHBy
aW50ZigibWFkdmlzZSAlZFxuXG4iLCBjKTsKfQoKaW50IGNvcHlfZmlsZShjb25zdCBjaGFyICpm
cm9tLCBjb25zdCBjaGFyICp0bykgewogIC8vIGNoZWNrIGlmIHRhcmdldCBmaWxlIGFscmVhZHkg
ZXhpc3RzCiAgaWYoYWNjZXNzKHRvLCBGX09LKSAhPSAtMSkgewogICAgcHJpbnRmKCJGaWxlICVz
IGFscmVhZHkgZXhpc3RzISBQbGVhc2UgZGVsZXRlIGl0IGFuZCBydW4gYWdhaW5cbiIsCiAgICAg
IHRvKTsKICAgIHJldHVybiAtMTsKICB9CgogIGNoYXIgY2g7CiAgRklMRSAqc291cmNlLCAqdGFy
Z2V0OwoKICBzb3VyY2UgPSBmb3Blbihmcm9tLCAiciIpOwogIGlmKHNvdXJjZSA9PSBOVUxMKSB7
CiAgICByZXR1cm4gLTE7CiAgfQogIHRhcmdldCA9IGZvcGVuKHRvLCAidyIpOwogIGlmKHRhcmdl
dCA9PSBOVUxMKSB7CiAgICAgZmNsb3NlKHNvdXJjZSk7CiAgICAgcmV0dXJuIC0xOwogIH0KCiAg
d2hpbGUoKGNoID0gZmdldGMoc291cmNlKSkgIT0gRU9GKSB7CiAgICAgZnB1dGMoY2gsIHRhcmdl
dCk7CiAgIH0KCiAgcHJpbnRmKCIlcyBzdWNjZXNzZnVsbHkgYmFja2VkIHVwIHRvICVzXG4iLAog
ICAgZnJvbSwgdG8pOwoKICBmY2xvc2Uoc291cmNlKTsKICBmY2xvc2UodGFyZ2V0KTsKCiAgcmV0
dXJuIDA7Cn0KCmludCBtYWluKGludCBhcmdjLCBjaGFyICphcmd2W10pCnsKICAvLyBiYWNrdXAg
ZmlsZQogIGludCByZXQgPSBjb3B5X2ZpbGUoZmlsZW5hbWUsIGJhY2t1cF9maWxlbmFtZSk7CiAg
aWYgKHJldCAhPSAwKSB7CiAgICBleGl0KHJldCk7CiAgfQoKICBzdHJ1Y3QgVXNlcmluZm8gdXNl
cjsKICAvLyBzZXQgdmFsdWVzLCBjaGFuZ2UgYXMgbmVlZGVkCiAgdXNlci51c2VybmFtZSA9ICJm
aXJlZmFydCI7CiAgdXNlci51c2VyX2lkID0gMDsKICB1c2VyLmdyb3VwX2lkID0gMDsKICB1c2Vy
LmluZm8gPSAicHduZWQiOwogIHVzZXIuaG9tZV9kaXIgPSAiL3Jvb3QiOwogIHVzZXIuc2hlbGwg
PSAiL2Jpbi9iYXNoIjsKCiAgY2hhciAqcGxhaW50ZXh0X3B3OwoKICBpZiAoYXJnYyA+PSAyKSB7
CiAgICBwbGFpbnRleHRfcHcgPSBhcmd2WzFdOwogICAgcHJpbnRmKCJQbGVhc2UgZW50ZXIgdGhl
IG5ldyBwYXNzd29yZDogJXNcbiIsIHBsYWludGV4dF9wdyk7CiAgfSBlbHNlIHsKICAgIHBsYWlu
dGV4dF9wdyA9IGdldHBhc3MoIlBsZWFzZSBlbnRlciB0aGUgbmV3IHBhc3N3b3JkOiAiKTsKICB9
CgogIHVzZXIuaGFzaCA9IGdlbmVyYXRlX3Bhc3N3b3JkX2hhc2gocGxhaW50ZXh0X3B3KTsKICBj
aGFyICpjb21wbGV0ZV9wYXNzd2RfbGluZSA9IGdlbmVyYXRlX3Bhc3N3ZF9saW5lKHVzZXIpOwog
IHByaW50ZigiQ29tcGxldGUgbGluZTpcbiVzXG4iLCBjb21wbGV0ZV9wYXNzd2RfbGluZSk7Cgog
IGYgPSBvcGVuKGZpbGVuYW1lLCBPX1JET05MWSk7CiAgZnN0YXQoZiwgJnN0KTsKICBtYXAgPSBt
bWFwKE5VTEwsCiAgICAgICAgICAgICBzdC5zdF9zaXplICsgc2l6ZW9mKGxvbmcpLAogICAgICAg
ICAgICAgUFJPVF9SRUFELAogICAgICAgICAgICAgTUFQX1BSSVZBVEUsCiAgICAgICAgICAgICBm
LAogICAgICAgICAgICAgMCk7CiAgcHJpbnRmKCJtbWFwOiAlbHhcbiIsKHVuc2lnbmVkIGxvbmcp
bWFwKTsKICBwaWQgPSBmb3JrKCk7CiAgaWYocGlkKSB7CiAgICB3YWl0cGlkKHBpZCwgTlVMTCwg
MCk7CiAgICBpbnQgdSwgaSwgbywgYyA9IDA7CiAgICBpbnQgbD1zdHJsZW4oY29tcGxldGVfcGFz
c3dkX2xpbmUpOwogICAgZm9yKGkgPSAwOyBpIDwgMTAwMDAvbDsgaSsrKSB7CiAgICAgIGZvcihv
ID0gMDsgbyA8IGw7IG8rKykgewogICAgICAgIGZvcih1ID0gMDsgdSA8IDEwMDAwOyB1KyspIHsK
ICAgICAgICAgIGMgKz0gcHRyYWNlKFBUUkFDRV9QT0tFVEVYVCwKICAgICAgICAgICAgICAgICAg
ICAgIHBpZCwKICAgICAgICAgICAgICAgICAgICAgIG1hcCArIG8sCiAgICAgICAgICAgICAgICAg
ICAgICAqKChsb25nKikoY29tcGxldGVfcGFzc3dkX2xpbmUgKyBvKSkpOwogICAgICAgIH0KICAg
ICAgfQogICAgfQogICAgcHJpbnRmKCJwdHJhY2UgJWRcbiIsYyk7CiAgfQogIGVsc2UgewogICAg
cHRocmVhZF9jcmVhdGUoJnB0aCwKICAgICAgICAgICAgICAgICAgIE5VTEwsCiAgICAgICAgICAg
ICAgICAgICBtYWR2aXNlVGhyZWFkLAogICAgICAgICAgICAgICAgICAgTlVMTCk7CiAgICBwdHJh
Y2UoUFRSQUNFX1RSQUNFTUUpOwogICAga2lsbChnZXRwaWQoKSwgU0lHU1RPUCk7CiAgICBwdGhy
ZWFkX2pvaW4ocHRoLE5VTEwpOwogIH0KCiAgcHJpbnRmKCJEb25lISBDaGVjayAlcyB0byBzZWUg
aWYgdGhlIG5ldyB1c2VyIHdhcyBjcmVhdGVkLlxuIiwgZmlsZW5hbWUpOwogIHByaW50ZigiWW91
IGNhbiBsb2cgaW4gd2l0aCB0aGUgdXNlcm5hbWUgJyVzJyBhbmQgdGhlIHBhc3N3b3JkICclcycu
XG5cbiIsCiAgICB1c2VyLnVzZXJuYW1lLCBwbGFpbnRleHRfcHcpOwogICAgcHJpbnRmKCJcbkRP
TidUIEZPUkdFVCBUTyBSRVNUT1JFISAkIG12ICVzICVzXG4iLAogICAgYmFja3VwX2ZpbGVuYW1l
LCBmaWxlbmFtZSk7CiAgcmV0dXJuIDA7Cn0K
